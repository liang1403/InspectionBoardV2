<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>
    <!-- We support more than 40 localizations -->
    <script type="text/ecmascript" th:src="@{/jqGrid/js/i18n/grid.locale-ua.js}"></script>
    <!-- This is the Javascript file of jqGrid -->
    <script type="text/ecmascript" th:src="@{/jqGrid/src/jquery.jqGrid.js}"></script>
    <!-- This is the localization file of the grid controlling messages, labels, etc.
    <!-- A link to a jQuery UI ThemeRoller theme, more than 22 built-in and many more custom -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <!-- The link to the CSS that the grid needs -->
    <link rel="stylesheet" type="text/css" media="screen" th:href="@{/jqGrid/css/ui.jqgrid-bootstrap.css}" />

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>



    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<table id="exam_result_grid"></table>
<div id="exam_result_pager"></div>

<table id="application_grid"></table>
<div id="application_pager"></div>
<script>
    $.extend($.jgrid.defaults, {
        styleUI: 'Bootstrap',
        forceFit: true,
        datatype: 'json',
        gridview: true,
        rowList: [5, 10, 20],
        rownumbers: true,
        serializeGridData: function (data) {
            data.page--;
            return data;
        },
        jsonReader: {
            root: "content",
            repeatitems: false,
            records: "totalElements",
            page: function(data) {
                data.number++;
                return data;
            },
            total: "totalPages"
        }
    });

    $.ajaxSetup({
        contentType: "application/json",
        dataType: "json"
    });

    /*$.extend($.jgrid.ajaxOptions, {
        contentType: "application/json"
    });*/



    $("#exam_result_grid")
        .jqGrid({
            url: '/exam_result/entities',
            caption: "Exam results",
            pager: '#exam_result_pager',
            height: '250',
            viewrecords: true,
            colModel: [
                {
                    name: 'subject',
                    label: 'Subject',
                    jsonmap: 'subject.name',
                    width: 300,
                    editable: true,
                    editrules: {required: true}
                },
                {
                    name: 'mark',
                    label: 'Mark',
                    width: 200
                },
                {
                    name: 'state',
                    label: 'State',
                    width: 80,
                    editable:true,
                    cellEdit:true,
                    edittype: 'select',
                    formatter: 'select',
                    editoptions:{dataUrl: '/exam_result/states'}
                }
            ]
        })
        .navGrid('#exam_result_pager',
            {
                edit: true,
                add: true,
                del: false,
                search: true
            },
            {
                mtype: 'PUT',
                onclickSubmit: function (params, postdata) {
                    params.url = '/enrollee/update/' + postdata.grid_id;
                },
                serializeEditData: function (data) {
                    delete data.oper;
                    return JSON.stringify(data);
                }
            },
            {
                mtype: "POST",
                onclickSubmit: function (params, postdata) {
                    params.url = '/enrollee/create';
                },
                serializeEditData: function (data) {
                    delete data.oper;
                    return JSON.stringify(data);
                }
            },
            {
                mtype: 'DELETE',
                onclickSubmit: function (params, postdata) {
                    params.url = '/enrollee/delete/' + postdata.grid_id;
                }
            });
</script>
</body>
</html>